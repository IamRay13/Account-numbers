
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Secure Labels — Accounts & IDs</title>
  <!-- SVG favicon -->
  <link rel="icon" type="image/svg+xml" href='data:image/svg+xml;utf8,
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
      <defs>
        <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0" stop-color="%23006CFF"/>
          <stop offset="1" stop-color="%2300C2A8"/>
        </linearGradient>
      </defs>
      <rect width="64" height="64" rx="12" fill="url(%23g)"/>
      <g fill="white">
        <rect x="16" y="18" width="32" height="24" rx="4"/>
        <rect x="24" y="12" width="24" height="24" rx="4" opacity="0.8"/>
      </g>
    </svg>' />
  <meta name="color-scheme" content="light dark" />

  <style>
    :root {
      /* Professional, modern palette */
      --bg: #0f1216;
      --bg-elev: #151922;
      --card: #1a1f2b;
      --accent: #006CFF;
      --accent-2: #00C2A8;
      --text: #e9eef8;
      --muted: #9aa6b2;
      --border: #2a3342;
      --good: #1DB954;
      --danger: #e5484d;
      --warn: #ffb020;

      --radius: 12px;
      --radius-sm: 9px;
      --shadow: 0 8px 24px rgba(0,0,0,0.25);
      --shadow-soft: 0 4px 16px rgba(0,0,0,0.18);
      --focus: 0 0 0 2px color-mix(in oklab, var(--accent) 65%, white 35%);
    }
    @media (prefers-color-scheme: light) {
      :root {
        --bg: #f5f7fb;
        --bg-elev: #ffffff;
        --card: #ffffff;
        --text: #0d1321;
        --muted: #5b6677;
        --border: #e6e9ee;
        --shadow: 0 8px 24px rgba(10, 20, 40, 0.08);
        --shadow-soft: 0 4px 16px rgba(10, 20, 40, 0.06);
      }
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      background: linear-gradient(180deg, var(--bg) 0%, color-mix(in oklab, var(--bg) 84%, var(--bg-elev)) 100%);
      color: var(--text);
      font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    /* App shell */
    .app {
      max-width: 1000px;
      margin: 0 auto;
      padding: 24px;
    }

    .header {
      display: grid;
      grid-template-columns: 1fr auto auto;
      gap: 12px;
      align-items: center;
      margin-bottom: 16px;
    }
    @media (max-width: 720px) {
      .header {
        grid-template-columns: 1fr;
      }
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      background: var(--bg-elev);
      border: 1px solid var(--border);
      padding: 12px 14px;
      border-radius: var(--radius);
      box-shadow: var(--shadow-soft);
    }
    .brand svg { width: 26px; height: 26px; }
    .brand h1 {
      font-size: 18px;
      margin: 0;
      letter-spacing: 0.2px;
      font-weight: 650;
    }
    .brand small { color: var(--muted); }

    /* Controls */
    .controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: linear-gradient(180deg, var(--bg-elev), color-mix(in oklab, var(--bg-elev) 80%, var(--card)));
      color: var(--text);
      box-shadow: var(--shadow-soft);
      cursor: pointer;
      user-select: none;
      transition: transform 0.04s ease, background 0.2s ease, border-color 0.2s ease;
    }
    .btn:hover { transform: translateY(-1px); border-color: color-mix(in oklab, var(--border) 70%, var(--accent) 30%); }
    .btn:active { transform: translateY(0); }
    .btn.primary { background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 40%, var(--bg-elev)), var(--accent)); border-color: color-mix(in oklab, var(--accent) 40%, var(--border)); color: white; }
    .btn.warn { background: linear-gradient(180deg, color-mix(in oklab, var(--warn) 40%, var(--bg-elev)), var(--warn)); border-color: color-mix(in oklab, var(--warn) 40%, var(--border)); color: white; }
    .btn svg { width: 16px; height: 16px; }

    /* Search with clear button */
    .search-wrap {
      position: relative;
      display: flex;
      align-items: center;
      width: 100%;
    }
    .search {
      width: 100%;
      padding: 10px 36px 10px 36px;
      border-radius: var(--radius);
      border: 1px solid var(--border);
      background: var(--bg-elev);
      color: var(--text);
      box-shadow: var(--shadow-soft);
      outline: none;
    }
    .search::placeholder { color: var(--muted); }
    .search-icon {
      position: absolute; left: 10px; color: var(--muted);
    }
    .clear-btn {
      position: absolute; right: 8px;
      display: inline-flex; align-items: center; justify-content: center;
      width: 24px; height: 24px;
      border-radius: 50%;
      border: 1px solid var(--border);
      background: var(--card);
      color: var(--muted);
      cursor: pointer;
    }

    /* Sorter */
    .sort {
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: var(--bg-elev);
      color: var(--text);
      box-shadow: var(--shadow-soft);
      outline: none;
    }

    /* List */
    .list {
      margin-top: 16px;
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .item {
      display: grid;
      grid-template-columns: 1fr 1fr auto;
      gap: 10px;
      align-items: center;
      padding: 12px;
      border-top: 1px solid var(--border);
    }
    .item:first-child { border-top: none; }
    .item:hover { background: color-mix(in oklab, var(--card) 85%, var(--bg-elev)); }

    @media (max-width: 720px) {
      .item {
        grid-template-columns: 1fr;
        gap: 8px;
      }
      .item-actions { justify-self: start; }
    }

    .cell {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px;
      border: 1px dashed transparent;
      border-radius: var(--radius-sm);
      cursor: pointer;
      background: linear-gradient(180deg, color-mix(in oklab, var(--card) 92%, var(--bg-elev)), var(--card));
    }
    .cell:hover { border-color: color-mix(in oklab, var(--border) 60%, var(--accent) 40%); }
    .cell .label { font-weight: 600; letter-spacing: 0.2px; }
    .cell .value { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }

    .item-actions {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      justify-self: end;
    }
    .icon-btn {
      width: 34px; height: 34px;
      display: inline-flex; align-items: center; justify-content: center;
      border-radius: 10px;
      border: 1px solid var(--border);
      background: var(--bg-elev);
      color: var(--text);
      cursor: pointer;
      transition: transform 0.06s ease, background 0.2s ease;
    }
    .icon-btn:hover { transform: translateY(-1px); }
    .icon-btn.edit { color: var(--accent); }
    .icon-btn.delete { color: var(--danger); }

    /* Empty state */
    .empty {
      padding: 24px;
      text-align: center;
      color: var(--muted);
    }

    /* Dialog */
    dialog {
      border: none;
      border-radius: 16px;
      padding: 0;
      overflow: hidden;
      box-shadow: var(--shadow);
      background: var(--card);
      color: var(--text);
      width: min(520px, 92vw);
    }
    .dlg-head {
      padding: 16px;
      background: linear-gradient(180deg, color-mix(in oklab, var(--accent) 18%, var(--card)), var(--card));
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; gap: 8px;
    }
    .dlg-body { padding: 16px; display: grid; gap: 12px; }
    .field { display: grid; gap: 6px; }
    .field label { color: var(--muted); font-weight: 600; }
    .input {
      padding: 10px 12px;
      border-radius: var(--radius-sm);
      border: 1px solid var(--border);
      background: var(--bg-elev);
      color: var(--text);
      outline: none;
    }
    .dlg-actions {
      padding: 12px 16px;
      display: flex; justify-content: space-between; align-items: center;
      border-top: 1px solid var(--border);
      background: var(--bg-elev);
    }

    /* Toast */
    .toast {
      position: fixed;
      left: 50%;
      bottom: 24px;
      transform: translateX(-50%) translateY(20px);
      background: var(--good);
      color: white;
      padding: 10px 14px;
      border-radius: 999px;
      box-shadow: var(--shadow);
      opacity: 0;
      pointer-events: none;
      transition: transform 0.2s ease, opacity 0.2s ease;
      z-index: 9999;
    }
    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Footer help */
    .footer {
      margin-top: 16px;
      color: var(--muted);
      font-size: 12px;
      display: flex; justify-content: space-between; align-items: center;
      gap: 8px;
    }
    .kbd {
      display: inline-flex; align-items: center; justify-content: center;
      min-width: 22px; height: 22px;
      padding: 0 6px;
      border-radius: 6px;
      border: 1px solid var(--border);
      background: var(--bg-elev);
      color: var(--text);
      box-shadow: var(--shadow-soft);
      font-weight: 600;
      font-size: 12px;
    }

    /* Focus styles */
    :focus-visible { box-shadow: var(--focus); outline: none; }
  </style>
</head>
<body>
  <div class="app" id="app" aria-live="polite">
    <!-- Header -->
    <div class="header">
      <div class="brand" aria-label="Secure Labels">
        <svg viewBox="0 0 64 64" aria-hidden="true">
          <defs>
            <linearGradient id="g2" x1="0" y1="0" x2="1" y2="1">
              <stop offset="0" stop-color="#006CFF"/>
              <stop offset="1" stop-color="#00C2A8"/>
            </linearGradient>
          </defs>
          <rect width="64" height="64" rx="12" fill="url(#g2)"/>
          <g fill="white">
            <rect x="16" y="18" width="32" height="24" rx="4"/>
            <rect x="24" y="12" width="24" height="24" rx="4" opacity="0.8"/>
          </g>
        </svg>
        <div>
          <h1>Secure Labels</h1>
          <small>Tap to copy. Add, edit, delete. Import/Export JSON. Local storage.</small>
        </div>
      </div>

      <div class="controls" role="group" aria-label="Primary actions">
        <button class="btn primary" id="addBtn" title="Add (Shortcut: A)">
          <!-- plus icon -->
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M11 5a1 1 0 0 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6V5Z"/></svg>
          Add
        </button>
        <button class="btn" id="exportBtn" title="Export (Shortcut: E)">
          <!-- export icon -->
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 3a1 1 0 0 1 1 1v9.586l2.293-2.293a1 1 0 1 1 1.414 1.414l-4 4a1 1 0 0 1-1.414 0l-4-4A1 1 0 1 1 8.707 11.293L11 13.586V4a1 1 0 0 1 1-1ZM5 19a1 1 0 0 0 1 1h12a1 1 0 1 0 0-2H6a1 1 0 0 0-1 1Z"/></svg>
          Export
        </button>
        <button class="btn" id="importBtn" title="Import (Shortcut: I)">
          <!-- import icon -->
          <svg viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M12 21a1 1 0 0 1-1-1v-9.586L8.707 12.707a1 1 0 1 1-1.414-1.414l4-4a1 1 0 0 1 1.414 0l4 4a1 1 0 1 1-1.414 1.414L13 10.414V20a1 1 0 0 1-1 1ZM5 5a1 1 0 0 1 1-1h12a1 1 0 1 1 0 2H6a1 1 0 0 1-1-1Z"/></svg>
          Import
        </button>
        <input type="file" id="fileInput" accept=".json,application/json" hidden />
      </div>

      <div class="controls">
        <div class="search-wrap" role="search">
          <svg class="search-icon" viewBox="0 0 24 24" width="18" height="18" aria-hidden="true">
            <path fill="currentColor" d="M10 3a7 7 0 1 1 0 14 7 7 0 0 1 0-14Zm8.707 14.293a1 1 0 0 1 0 1.414l-2.586 2.586a1 1 0 1 1-1.414-1.414l2.586-2.586a1 1 0 0 1 1.414 0Z"/>
          </svg>
          <input id="search" class="search" type="search" placeholder="Search labels or values…" autocomplete="off" />
          <button id="clearSearch" class="clear-btn" title="Clear search">
            <svg viewBox="0 0 24 24" width="14" height="14" aria-hidden="true">
              <path fill="currentColor" d="M6.343 6.343a1 1 0 0 1 1.414 0L12 10.586l4.243-4.243a1 1 0 1 1 1.414 1.414L13.414 12l4.243 4.243a1 1 0 1 1-1.414 1.414L12 13.414l-4.243 4.243a1 1 0 1 1-1.414-1.414L10.586 12 6.343 7.757a1 1 0 0 1 0-1.414Z"/>
            </svg>
          </button>
        </div>
        <select id="sort" class="sort" aria-label="Sort">
          <option value="label-asc">Sort: Label A–Z</option>
          <option value="updated-desc">Sort: Last updated</option>
        </select>
      </div>
    </div>

    <!-- List -->
    <div class="list" id="list" role="list"></div>
    <div class="empty" id="empty" hidden>No items yet. Press <span class="kbd">A</span> to add, <span class="kbd">I</span> to import.</div>

    <!-- Toast -->
    <div class="toast" id="toast" role="status" aria-live="polite">Copied</div>

    <!-- Dialog -->
    <dialog id="dialog">
      <form id="dialogForm" method="dialog">
        <div class="dlg-head">
          <svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path fill="currentColor" d="M11 5a1 1 0 0 1 2 0v6h6a1 1 0 1 1 0 2h-6v6a1 1 0 1 1-2 0v-6H5a1 1 0 1 1 0-2h6V5Z"/></svg>
          <strong id="dialogTitle">Add item</strong>
        </div>
        <div class="dlg-body">
          <div class="field">
            <label for="labelInput">Label</label>
            <input id="labelInput" class="input" name="label" placeholder="e.g., PLDT Account number" required />
          </div>
          <div class="field">
            <label for="valueInput">Value</label>
            <input id="valueInput" class="input" name="value" placeholder="e.g., 123456789" required />
          </div>
        </div>
        <div class="dlg-actions">
          <button type="button" class="btn" id="cancelDialog">Cancel</button>
          <div style="display:flex;gap:8px">
            <button type="submit" class="btn primary" id="saveDialog">Save</button>
          </div>
        </div>
      </form>
    </dialog>

    <!-- Footer -->
    <div class="footer">
      <div>
        <strong>Shortcuts:</strong>
        <span class="kbd">A</span> Add
        <span class="kbd">E</span> Export
        <span class="kbd">I</span> Import
      </div>
      <div>
        Tap either a label or value to copy. Green toast confirms.
      </div>
    </div>
  </div>

  <script>
    ;(() => {
      const STORAGE_KEY = 'secure-labels:v1';
      const listEl = document.getElementById('list');
      const emptyEl = document.getElementById('empty');
      const toastEl = document.getElementById('toast');
      const searchEl = document.getElementById('search');
      const clearSearchEl = document.getElementById('clearSearch');
      const sortEl = document.getElementById('sort');
      const addBtn = document.getElementById('addBtn');
      const exportBtn = document.getElementById('exportBtn');
      const importBtn = document.getElementById('importBtn');
      const fileInput = document.getElementById('fileInput');

      const dialog = document.getElementById('dialog');
      const dialogForm = document.getElementById('dialogForm');
      const dialogTitle = document.getElementById('dialogTitle');
      const labelInput = document.getElementById('labelInput');
      const valueInput = document.getElementById('valueInput');
      const cancelDialog = document.getElementById('cancelDialog');
      const saveDialog = document.getElementById('saveDialog');

      // In-memory state
      let state = {
        items: [],
        search: '',
        sort: 'label-asc',
        editingId: null
      };

      // Sample initial data (mapped to label/value)
      const sampleData = [
       
        {"id":"MHWCCDD9YDH3SO","bankName":"Sample Data","accountNumber":"HERE IT IS"}
      ].map(x => ({
        id: x.id,
        label: x.bankName,
        value: x.accountNumber,
        updatedAt: Date.now()
      }));

      // Utilities
      const uid = () => Math.random().toString(36).slice(2, 10).toUpperCase() + Math.random().toString(36).slice(2, 6).toUpperCase();
      const persist = () => localStorage.setItem(STORAGE_KEY, JSON.stringify(state.items));
      const load = () => {
        try {
          const raw = localStorage.getItem(STORAGE_KEY);
          if (raw) {
            const arr = JSON.parse(raw);
            if (Array.isArray(arr)) return arr.map(migrateItem);
          }
        } catch {}
        return sampleData;
      };
      const migrateItem = (it) => {
        // Ensure schema {id,label,value,updatedAt}
        return {
          id: it.id || uid(),
          label: it.label ?? it.bankName ?? '',
          value: it.value ?? it.accountNumber ?? '',
          updatedAt: it.updatedAt ?? Date.now()
        };
      };

      const showToast = (msg = 'Copied') => {
        toastEl.textContent = msg;
        toastEl.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(() => toastEl.classList.remove('show'), 1400);
      };

      const copyText = async (text) => {
        try {
          await navigator.clipboard.writeText(text);
          showToast('Copied');
        } catch {
          // Fallback
          const ta = document.createElement('textarea');
          ta.value = text;
          document.body.appendChild(ta);
          ta.select();
          try { document.execCommand('copy'); showToast('Copied'); } catch {}
          ta.remove();
        }
      };

      // Filtering and sorting
      const getVisible = () => {
        const q = state.search.trim().toLowerCase();
        let items = [...state.items];
        if (q) {
          items = items.filter(it =>
            it.label.toLowerCase().includes(q) ||
            it.value.toLowerCase().includes(q)
          );
        }
        if (state.sort === 'label-asc') {
          items.sort((a, b) => a.label.localeCompare(b.label, undefined, { sensitivity: 'base' }));
        } else if (state.sort === 'updated-desc') {
          items.sort((a, b) => b.updatedAt - a.updatedAt);
        }
        return items;
      };

      // Render
      const render = () => {
        const items = getVisible();
        listEl.innerHTML = '';
        if (!items.length) {
          emptyEl.hidden = false;
          return;
        }
        emptyEl.hidden = true;
        const frag = document.createDocumentFragment();
        items.forEach(it => {
          const row = document.createElement('div');
          row.className = 'item';
          row.setAttribute('role', 'listitem');

          // Left cell: Label
          const labelCell = document.createElement('div');
          labelCell.className = 'cell';
          labelCell.title = 'Tap to copy label';
          labelCell.innerHTML = `
            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" style="color:var(--accent)">
              <path fill="currentColor" d="M7 7a3 3 0 0 1 3-3h7a3 3 0 0 1 3 3v7a3 3 0 0 1-3 3h-7a3 3 0 0 1-3-3V7Zm-2 4a1 1 0 0 1 2 0v6a3 3 0 0 0 3 3h6a1 1 0 1 1 0 2H10a5 5 0 0 1-5-5v-6Z"/>
            </svg>
            <span class="label">${escapeHtml(it.label)}</span>
          `;
          labelCell.addEventListener('click', () => copyText(it.label));

          // Right cell: Value
          const valueCell = document.createElement('div');
          valueCell.className = 'cell';
          valueCell.title = 'Tap to copy value';
          valueCell.innerHTML = `
            <svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true" style="color:var(--accent-2)">
              <path fill="currentColor" d="M7 7a3 3 0 0 1 3-3h7a3 3 0 0 1 3 3v7a3 3 0 0 1-3 3h-7a3 3 0 0 1-3-3V7Zm-2 4a1 1 0 0 1 2 0v6a3 3 0 0 0 3 3h6a1 1 0 1 1 0 2H10a5 5 0 0 1-5-5v-6Z"/>
            </svg>
            <span class="value">${escapeHtml(it.value)}</span>
          `;
          valueCell.addEventListener('click', () => copyText(it.value));

          // Actions
          const actions = document.createElement('div');
          actions.className = 'item-actions';

          const editBtn = document.createElement('button');
          editBtn.className = 'icon-btn edit';
          editBtn.title = 'Edit';
          editBtn.innerHTML = `<svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path fill="currentColor" d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25Zm18.71-10.04a1.004 1.004 0 0 0 0-1.42L18.21 2.29a1.004 1.004 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.83-1.86Z"/>
            </svg>`;
          editBtn.addEventListener('click', () => openDialog('edit', it));

          const delBtn = document.createElement('button');
          delBtn.className = 'icon-btn delete';
          delBtn.title = 'Delete';
          delBtn.innerHTML = `<svg viewBox="0 0 24 24" width="16" height="16" aria-hidden="true">
              <path fill="currentColor" d="M9 3a1 1 0 0 0-1 1v1H5a1 1 0 1 0 0 2h14a1 1 0 1 0 0-2h-3V4a1 1 0 0 0-1-1H9Zm-3 6a1 1 0 0 1 1 1v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V10a1 1 0 1 1 2 0v9a4 4 0 0 1-4 4H9a4 4 0 0 1-4-4V10a1 1 0 0 1 1-1Zm4 1a1 1 0 0 1 1 1v7a1 1 0 1 1-2 0v-7a1 1 0 0 1 1-1Zm4 0a1 1 0 0 1 1 1v7a1 1 0 1 1-2 0v-7a1 1 0 0 1 1-1Z"/>
            </svg>`;
          delBtn.addEventListener('click', () => {
            if (confirm(`Delete "${it.label}"?`)) {
              state.items = state.items.filter(x => x.id !== it.id);
              persist();
              render();
            }
          });

          actions.append(editBtn, delBtn);
          row.append(labelCell, valueCell, actions);
          frag.appendChild(row);
        });
        listEl.appendChild(frag);
      };

      // Dialog handling
      const openDialog = (mode, item) => {
        state.editingId = mode === 'edit' ? item.id : null;
        dialogTitle.textContent = mode === 'edit' ? 'Edit item' : 'Add item';
        labelInput.value = mode === 'edit' ? item.label : '';
        valueInput.value = mode === 'edit' ? item.value : '';
        dialog.showModal();
        setTimeout(() => labelInput.focus(), 50);
      };
      const closeDialog = () => dialog.close();

      dialogForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const label = labelInput.value.trim();
        const value = valueInput.value.trim();
        if (!label || !value) return;

        if (state.editingId) {
          const idx = state.items.findIndex(x => x.id === state.editingId);
          if (idx >= 0) {
            state.items[idx] = {
              ...state.items[idx],
              label, value,
              updatedAt: Date.now()
            };
          }
        } else {
          state.items.push({
            id: uid(),
            label, value,
            updatedAt: Date.now()
          });
        }
        persist();
        closeDialog();
        render();
      });
      cancelDialog.addEventListener('click', closeDialog);

      // Events: search, clear, sort
      searchEl.addEventListener('input', () => { state.search = searchEl.value; render(); });
      clearSearchEl.addEventListener('click', () => { searchEl.value = ''; state.search = ''; render(); });

      sortEl.addEventListener('change', () => { state.sort = sortEl.value; render(); });

      // Add / Export / Import
      addBtn.addEventListener('click', () => openDialog('add'));
      exportBtn.addEventListener('click', () => {
        const exportArr = state.items.map(({id, label, value}) => ({
          id,
          bankName: label,
          accountNumber: value
        }));
        const blob = new Blob([JSON.stringify(exportArr, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `secure-labels-${new Date().toISOString().slice(0,19).replace(/[:T]/g,'-')}.json`;
        document.body.appendChild(a);
        a.click();
        a.remove();
        URL.revokeObjectURL(url);
      });
      importBtn.addEventListener('click', () => fileInput.click());
      fileInput.addEventListener('change', async (e) => {
        const file = e.target.files?.[0];
        if (!file) return;
        try {
          const text = await file.text();
          const arr = JSON.parse(text);
          if (!Array.isArray(arr)) throw new Error('Invalid JSON format');
          const mapped = arr.map(migrateItem);
          // Merge by id, update or add
          const map = new Map(state.items.map(i => [i.id, i]));
          mapped.forEach(m => map.set(m.id, { ...map.get(m.id), ...m, updatedAt: Date.now() }));
          state.items = Array.from(map.values());
          persist();
          render();
        } catch (err) {
          alert('Import failed: ' + (err?.message || 'Unknown error'));
        } finally {
          fileInput.value = '';
        }
      });

      // Keyboard shortcuts (A/E/I when not typing inside inputs or dialog open)
      document.addEventListener('keydown', (e) => {
        const tag = (e.target.tagName || '').toLowerCase();
        const typing = ['input', 'textarea', 'select'].includes(tag);
        const dialogOpen = dialog.open === true;
        if (typing || dialogOpen) return;

        if (e.key.toLowerCase() === 'a') { e.preventDefault(); openDialog('add'); }
        else if (e.key.toLowerCase() === 'e') { e.preventDefault(); exportBtn.click(); }
        else if (e.key.toLowerCase() === 'i') { e.preventDefault(); importBtn.click(); }
      });

      // Accessibility: copy with Enter/Space
      listEl.addEventListener('keydown', (e) => {
        const tgt = e.target;
        if (tgt.classList?.contains('cell') && (e.key === 'Enter' || e.key === ' ')) {
          e.preventDefault();
          const span = tgt.querySelector('.label, .value');
          span && copyText(span.textContent || '');
        }
      });

      // Escape HTML
      function escapeHtml(s) {
        return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
      }

      // Initialize
      state.items = load();
      render();

      // Progressive enhancement: improve touch feedback
      document.querySelectorAll('.cell,.btn,.icon-btn').forEach(el => {
        el.addEventListener('touchstart', () => el.style.transform = 'scale(0.99)'), { passive: true };
        el.addEventListener('touchend', () => el.style.transform = '');
      });
    })();
  </script>
</body>
</html>
